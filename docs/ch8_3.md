[back](ch8.md) | [main menu](../README.md)
 
## 8.3 More scenes

### 8.3.1 Three objects

Program: ch8_3_F\SG03.java

This example is a scene of three objects, as illustrated in Figure 8.x. The scene graph classes introduced in section 8.2 are used again.

<p align="center">
  <img src="ch8_img/ch8_3_F.png" alt="three objects" width="200"><br>
  <strong>Figure 8.x:</strong> A scene containing three objects.
</p>

Program Listing 8.x sets up the class attributes for the scene and creates the textures and light and makes the pieces with some helper classes. cubeLower and cubeUpper will be joined together with a scene graph. fStemCube, fTopCube and fMiddleCube will be joined together using another scene graph.

```java
private Model floor, cubeLower, cubeUpper, sphere, fStemCube, fTopCube, fMiddleCube;
private Light light;
private SGNode cuboidsRoot, fShapeRoot;

// textures
private TextureLibrary textures;


public void initialise(GL3 gl) {
  // create textures

  // create light

  floor = makeFloor(gl, getM1(), "assets/shaders/fs_standard_d.txt", textures.get("chequerboard"), null, null);
  
  Material materialCube = MaterialConstants.green.clone();
  cubeLower = makeCube(gl, new Mat4(1), materialCube,
                      "assets/shaders/fs_standard_0t.txt", 
                      null,null,null);

  materialCube = MaterialConstants.red.clone();
  cubeUpper = makeCube(gl, new Mat4(1), materialCube,
                      "assets/shaders/fs_standard_0t.txt", 
                      null,null,null);

  materialCube = MaterialConstants.blue.clone();
  fStemCube = makeCube(gl, new Mat4(1), materialCube,
                      "assets/shaders/fs_standard_0t.txt", 
                      null,null,null);

  fTopCube = makeCube(gl, new Mat4(1), materialCube,
                      "assets/shaders/fs_standard_0t.txt", 
                      null,null,null);

  fMiddleCube = makeCube(gl, new Mat4(1), materialCube,
                      "assets/shaders/fs_standard_0t.txt", 
                      null,null,null);

  Mat4 mSphere = Mat4Transform.translate(0,0.5f,0);
  mSphere = Mat4.multiply(Mat4Transform.scale(2,4,2),mSphere);
  sphere = makeSphere(gl, mSphere,
                      "assets/shaders/fs_standard_d.txt", 
                      textures.get("cloud"), null, null);


  // now do the scene graphs

}
```

Program Listing 8.x: ??????????????????

Program Listing 8.x joins two cubes together into a scene graph with root called cuboidsRoot. One cube is stacked on top of the other. Again, certain literals could be replaced by variables to make the program more flexible.

```java
// ...

public void initialise(GL3 gl) {
  // ...

  // cuboids
  cuboidsRoot = new SGNameNode("two-cuboid structure");
  SGTransformNode translateInPlane = new SGTransformNode("translate(1.7,0,1.3)",Mat4Transform.translate(2.7f, 0f, 2.3f));
  SGNameNode lowerCuboid = new SGNameNode("lower cuboid");
  Mat4 m = Mat4Transform.scale(1,1,1);
  m = Mat4.multiply(m, Mat4Transform.translate(0,0.5f,0));
  SGTransformNode lowerCubeTransform = new SGTransformNode("some transforms", m);
  SGModelNode lowerCubeShape = new SGModelNode("cubeLower", cubeLower);
  SGTransformNode translateToTop = new SGTransformNode("translate(0,4,0)",Mat4Transform.translate(0,0,0));
  SGNameNode upperCuboid = new SGNameNode("upper cuboid");
  m = Mat4Transform.scale(0.6f,3.5f,0.6f);
  m = Mat4.multiply(m, Mat4Transform.translate(0,0.5f,0));
  SGTransformNode upperCubeTransform = new SGTransformNode("some transforms", m);
  SGModelNode upperCubeShape = new SGModelNode("cubeUpper", cubeUpper);

  cuboidsRoot.addChild(translateInPlane);
    translateInPlane.addChild(lowerCuboid);
      lowerCuboid.addChild(lowerCubeTransform);
        lowerCubeTransform.addChild(lowerCubeShape);
      lowerCuboid.addChild(translateToTop);
        translateToTop.addChild(upperCuboid);
          upperCuboid.addChild(upperCubeTransform);
            upperCubeTransform.addChild(upperCubeShape);
    cuboidsRoot.update(); 

  // F shape

}
```

Program Listing 8.x: ??????????????????

Program Listing 8.x joins three cubes together into a scene graph with root called fShapeRoot. Again, certain literals could be replaced by variables to make the program more flexible.

```java
// ...

public void initialise(GL3 gl) {
  // ...
  // cuboids
  // ...
  // F shape
  fShapeRoot = new SGNameNode("f structure");
  SGTransformNode translateFInPlane = new SGTransformNode("translate(0.2,0,1.7)",Mat4Transform.translate(0.2f,0f,2.7f));

  SGNameNode fStem = new SGNameNode("fStem");
  m = Mat4Transform.scale(0.5f,3,1);
  m = Mat4.multiply(m, Mat4Transform.translate(0,0.5f,0));
  SGTransformNode fStemTransform = new SGTransformNode("some transforms", m);
  SGModelNode fStemShape = new SGModelNode("cubeLower", fStemCube);

  SGNameNode fMiddle = new SGNameNode("fMiddle");
  m = Mat4Transform.translate(0.5f,1f,0);
  m = Mat4.multiply(m, Mat4Transform.scale(1,0.5f,1));
  m = Mat4.multiply(m, Mat4Transform.translate(0,0.5f,0));
  SGTransformNode fMiddleTransform = new SGTransformNode("some transforms", m);
  SGModelNode fMiddleShape = new SGModelNode("cubeLower", fMiddleCube);

  SGNameNode fTop = new SGNameNode("fTop");
  m = Mat4Transform.translate(0.5f,2.5f,0);
  m = Mat4.multiply(m, Mat4Transform.scale(1.5f,0.5f,1));
  m = Mat4.multiply(m, Mat4Transform.translate(0,0.5f,0));
  SGTransformNode fTopTransform = new SGTransformNode("some transforms", m);
  SGModelNode fTopShape = new SGModelNode("cubeLower", fTopCube);

  fShapeRoot.addChild(translateFInPlane);
    translateFInPlane.addChild(fStem);
      fStem.addChild(fStemTransform);
        fStemTransform.addChild(fStemShape);
      fStem.addChild(fMiddle);
        fMiddle.addChild(fMiddleTransform);
          fMiddleTransform.addChild(fMiddleShape);
      fStem.addChild(fTop);
        fTop.addChild(fTopTransform);
          fTopTransform.addChild(fTopShape);
  fShapeRoot.update();

}
```

Program Listing 8.x: ??????????????????

Finally, Program Listing 8.x renders the scene.

```java
public void render(GL3 gl) {
  gl.glClear(GL.GL_COLOR_BUFFER_BIT | GL.GL_DEPTH_BUFFER_BIT);

  light.setPosition(getLightPosition()); // changing light position each frame

  light.render(gl);

  floor.render(gl);
  sphere.render(gl);
  
  cuboidsRoot.draw(gl);
  fShapeRoot.draw(gl);
}
```

Program Listing 8.x: ??????????????????

---

### 8.3.2 Controlling relationships between the three objects

Program: ch8_3_F2\SG04.java

This example repeats the scene from the previous section, but adds some extra transformations into the two scene graphs to enable the objects to be controlled from the user interface. Figure 8.x illustrates this. The F shape can be rotated by 180 degrees around the y axis and the bottom cuboid in the stack of cuboids can be independently rotated about the y axis.

<p align="center">
  <img src="ch8_img/ch8_3_F.png" alt="three objects" width="200">.<img src="ch8_img/ch8_3_F2.png" alt="three objects" width="200"> <br>
  <strong>Figure 8.x:</strong> Interface controls are introduced to allow parts of the scene to be changed.
</p>

Program Listing 8.x shows the node that need to be introduced into the previous example for the cuboids stack. A rotateAroundY SGTransformNode is created and added in the branch for controlling the lower cuboid only. It does not affect the upperCuboid. Likewise, Program Listing 8.x shows the node that need to be introduced into the previous example for the F object. Again, a rotateAroundY node is added. This affects every child below it, i.e. all the cubes that are its children, thus the whole F rotates. The two rotateAroundY nodes are actually in different methods in the reformulated program which is why they are called the same name here. You should take some time to study the differences between this program and the previous one to increase your understanding of how scene graphs work.


```java
cuboidsRoot.addChild(translateInPlane);
  translateInPlane.addChild(lowerCuboid);
    lowerCuboid.addChild(rotateAroundY);           // added
      rotateAroundY.addChild(lowerCubeTransform);  // added
      lowerCubeTransform.addChild(lowerCubeShape);
    lowerCuboid.addChild(translateToTop);
      translateToTop.addChild(upperCuboid);
        upperCuboid.addChild(upperCubeTransform);
          upperCubeTransform.addChild(upperCubeShape);
cuboidsRoot.update(); 
```

Program Listing 8.x: ???

```java
fShapeRoot.addChild(translateFInPlane);
  translateFInPlane.addChild(rotateAroundY);  // added
  rotateAroundY.addChild(fStem);              // added
    fStem.addChild(fStemTransform);
      fStemTransform.addChild(fStemShape);
    fStem.addChild(fMiddle);
      fMiddle.addChild(fMiddleTransform);
        fMiddleTransform.addChild(fMiddleShape);
    fStem.addChild(fTop);
      fTop.addChild(fTopTransform);
        fTopTransform.addChild(fTopShape);
fShapeRoot.update();
```

Program Listing 8.x: ???


### 8.3.3 Branches that articulate with respect to one another

<p align="center">
  <img src="ch8_img/ch8_5_branches.png" alt="Articulating branches" width="200">.<img src="ch8_img/ch8_6_branches.png" alt="more articulating branches" width="200"> <br>
  <strong>Figure 8.x:</strong> (a) Articulating branches; (b) More articulating branches.
</p>



---

## MCQs (written in collaboration with Google Gemini)

GLSL???

---

## Exercises

1. ???

[back](ch8.md) | [main menu](../README.md)