[back](ch5.md) | [main menu](../README.md)
 
## 5.3 A Camera

Program: [V05.java](/ch5_t_cs_c/ch5_camera)

This program creates a camera that is under mouse and keyboard control. This is similar to the camera described in Joey's tutorial on a Camera. When you run the program, you will be able to fly through the scene of 100 cubes shown in Figure 5.6.

<p align="center">
  <img src="ch5_img/ch5_2_100_random_cubes.jpg" alt="A  triangle" width="200"><br>
  <strong>Figure 5.6.</strong> 100 randomly positioned cubes
</p>

<p align="center">
  <img src="ch5_img/ch5_3_camera.mp4" alt="A  triangle" width="200"><br>
  <strong>Figure 5.7.</strong> Moving the camera
</p>

An instance of the Camera class is created in V05.java (see Program Listing 5.11). Default values are used. The Camera instance is then passed to the V05_GLEventListener constructor. 

V05.java also contains classes for Keyboard input and Mouse input, each of which can set attributes in the Camera class based on user input. Holding down the left button and moving the mouse will move the direction that the camera is looking in. The W and S keys can be used to move in and out of the scene in the direction the camera is looking in. The Q and E keys can be used to move down and up, respectively. The A and D keys can be used move left and right, respectively. The shift key can be held in conjunction with the other keys to move in larger steps. Thus, the left hand controls all the keys and the right hand controls the mouse.

```java
public V05(String textForTitleBar) {
  super(textForTitleBar);
  GLCapabilities glcapabilities = new GLCapabilities(GLProfile.get(GLProfile.GL3));
  canvas = new GLCanvas(glcapabilities);
  
  Camera camera = new Camera(Camera.DEFAULT_POSITION, Camera.DEFAULT_TARGET, Camera.DEFAULT_UP);
  
  glEventListener = new V05_GLEventListener(camera);
  canvas.addGLEventListener(glEventListener);
  canvas.addMouseMotionListener(new MyMouseInput(camera));
  canvas.addKeyListener(new MyKeyboardInput(camera));
  getContentPane().add(canvas, BorderLayout.CENTER);

  //... rest of code
}
```

**Program Listing 5.11:** ????????????

Thereafter the render method in this class uses the Camera instance to retrieve the current view matrix (Program Listing 5.12). The rest of the render method is the same as previous programs.

```java
public class V05_GLEventListener implements GLEventListener {
  
  //...
  private Camera camera;
    
  public V05_GLEventListener(Camera camera) {
    this.camera = camera;
  }

  //...

  public void reshape(GLAutoDrawable drawable, int x, int y, int width, int height) {
    GL3 gl = drawable.getGL().getGL3();
    gl.glViewport(x, y, width, height);
    float aspect = (float)width/(float)height;

    Mat4 p = Mat4Transform.perspective(45, aspect);
    camera.setPerspectiveMatrix(p);
  }

  //...

  public void render(GL3 gl) {
    gl.glClear(GL.GL_COLOR_BUFFER_BIT | GL.GL_DEPTH_BUFFER_BIT);

    Mat4 projectionMatrix = camera.getPerspectiveMatrix();
    Mat4 viewMatrix = camera.getViewMatrix();  

    // use camera in rendering
  }

  //...
```

**Program Listing 5.12:** ????????????

The Camera class itself pulls together the material discussed in previous section. Part of this is given in Program Listing 5.13.

```java
import gmaths.*;
import java.awt.event.*;
import com.jogamp.opengl.awt.GLCanvas;

public class Camera {
  
  public enum CameraType {X, Z};
  public enum Movement {NO_MOVEMENT, FORWARD, BACK, LEFT, RIGHT, UP, DOWN,  
                        FAST_FORWARD, FAST_BACK, FAST_LEFT, FAST_RIGHT, FAST_UP, FAST_DOWN};
  
  public static final Vec3 DEFAULT_POSITION = new Vec3(0,0,25);
  public static final Vec3 DEFAULT_TARGET = new Vec3(0,0,0);
  public static final Vec3 DEFAULT_UP = new Vec3(0,1,0);

  public final float YAW = -90f;
  public final float PITCH = 0f;
  public final float KEYBOARD_SPEED = 0.2f;
  public final float FAST_KEYBOARD_SPEED = 1f;
  public final float MOUSE_SPEED = 1.0f;
  
  private Vec3 position;
  private Vec3 target;
  private Vec3 up;
  private Vec3 worldUp;
  private Vec3 front;
  private Vec3 right;
  
  private float yaw;
  private float pitch;
  
  private Mat4 perspective;

  public Camera(Vec3 position, Vec3 target, Vec3 up) {
    setupCamera(position, target, up);
  }

  //...
}
```

**Program Listing 5.13:** ???????

Take some time to read through Joey's tutorial and look at the new classes that I have created. It is not necessary that you understand all the mathematical details to be able to use the Camera class. You can just use it as it is in your programs. We will use it in subsequent Chapters and it can also be used in the assignment (as can any of the program code I have given you in this tutorial).

---

## MCQs (written in collaboration with Google Gemini)

GLSL???

---

## Exercises

1. Something about the maths package?


[back](ch5.md) | [main menu](../README.md)